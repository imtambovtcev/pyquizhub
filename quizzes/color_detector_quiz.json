{
  "metadata": {
    "title": "Image Color Detector",
    "description": "Upload an image and discover its dominant color! This quiz demonstrates file upload integration with external APIs.",
    "author": "PyQuizHub Team",
    "version": "1.0",
    "tags": ["file-upload", "api-integration", "demo"]
  },
  "permissions": {
    "tier": "ADVANCED",
    "requires_file_upload": true,
    "description": "This quiz requires file upload capabilities (ADVANCED tier)"
  },
  "variables": {
    "uploaded_file_id": {
      "type": "string",
      "mutable_by": ["user", "engine"],
      "tags": ["private"],
      "default": ""
    },
    "dominant_color": {
      "type": "string",
      "mutable_by": ["api"],
      "tags": ["public"],
      "default": "unknown"
    },
    "color_name": {
      "type": "string",
      "mutable_by": ["api"],
      "tags": ["public"],
      "default": "unknown"
    },
    "analysis_status": {
      "type": "string",
      "mutable_by": ["api"],
      "tags": ["public"],
      "default": "pending"
    }
  },
  "api_integrations": [
    {
      "id": "color_analyzer",
      "method": "POST",
      "timing": "before_question",
      "question_id": 2,
      "prepare_request": {
        "url_template": "http://172.18.0.1:5001/analyze",
        "required_variables": ["uploaded_file_id"],
        "body_template": "{file_upload:variables.uploaded_file_id}",
        "file_field_name": "image"
      },
      "extract_response": {
        "variables": {
          "dominant_color": {
            "path": "dominant_color",
            "type": "string"
          },
          "color_name": {
            "path": "color_name",
            "type": "string"
          },
          "analysis_status": {
            "path": "status",
            "type": "string"
          }
        }
      }
    }
  ],
  "questions": [
    {
      "id": 1,
      "data": {
        "type": "file_upload",
        "text": "Please upload an image file (JPG, PNG, GIF, or WebP)",
        "allowed_types": ["images"],
        "file_types": ["image/jpeg", "image/png", "image/gif", "image/webp"],
        "max_size_mb": 10,
        "description": "We'll analyze your image and tell you the dominant color!"
      },
      "score_updates": [
        {
          "condition": "answer.file_id != ''",
          "update": {
            "uploaded_file_id": "answer.file_id"
          }
        }
      ]
    },
    {
      "id": 2,
      "data": {
        "type": "final_message",
        "text": "ðŸŽ¨ **Color Analysis Results**\n\nYour image's dominant color is: **{variables.color_name}**\n\nHex Code: `{variables.dominant_color}`\n\nAnalysis Status: {variables.analysis_status}\n\nThank you for testing the file upload feature! ðŸŽ‰"
      }
    }
  ],
  "transitions": {
    "1": [
      {
        "expression": "uploaded_file_id != ''",
        "next_question_id": 2
      }
    ],
    "2": [
      {
        "expression": "true",
        "next_question_id": null
      }
    ]
  }
}
